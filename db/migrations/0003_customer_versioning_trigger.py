# Generated by Django 5.2.4 on 2025-07-28 11:21
# python manage.py makemigrations db --name customer_versioning_trigger --empty

from django.db import migrations

SQL = """
DROP TRIGGER IF EXISTS versioning_trigger ON db_customer;
CREATE TRIGGER versioning_trigger
BEFORE INSERT OR UPDATE OR DELETE ON db_customer
FOR EACH ROW EXECUTE PROCEDURE versioning(
  'sys_period',             -- sys_period
  'db_customerhistory',     -- history_table
  false,                    -- mitigate_update_conflicts
  false,                    -- ignore_unchanged_values
  false,                    -- include_current_version_in_history
  false,                    -- enable_migration_mode
  true,                     -- increment_version
  'version'                 -- version_column_name
);
"""

REVERSE_SQL = "DROP TRIGGER IF EXISTS versioning_trigger ON db_customer;"


class Migration(migrations.Migration):
    dependencies = [
        ("db", "0002_initial"),
    ]

    operations = [migrations.RunSQL(SQL, REVERSE_SQL)]
